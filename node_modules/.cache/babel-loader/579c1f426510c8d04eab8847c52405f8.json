{"ast":null,"code":"var _jsxFileName = \"/Users/sofiapacheco/Desktop/T3/t3/src/App.js\";\nimport React from 'react';\nimport './styles/App.css';\nimport * as io from 'socket.io-client';\nimport { withStyles, makeStyles } from '@material-ui/core/styles';\nimport { GridList, GridListTile, Table, TableBody, TableCell, TableHead, TableRow } from '@material-ui/core/';\nimport { Line, LineChart, XAxis, YAxis, Tooltip, CartesianGrid } from 'recharts';\nconst StyledTableCell = withStyles(theme => ({\n  head: {\n    backgroundColor: theme.palette.common.black,\n    color: theme.palette.common.white,\n    fontSize: 12\n  },\n  body: {\n    fontSize: 12\n  }\n}))(TableCell);\n\nclass App extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      exchange: {},\n      stocks: {},\n      ready_stock: false,\n      ready_exchange: false,\n      on: false\n    };\n  }\n\n  getInitialStock(socket) {\n    console.log('hola');\n    let copyStocks = {};\n    socket.emit('STOCKS');\n    socket.on('STOCKS', data => {\n      console.log(data);\n\n      for (const num in data) {\n        copyStocks[data[num]['ticker']] = {\n          'company_name': data[num]['company_name'],\n          'country': data[num]['country'],\n          'total_volume': 0,\n          'higher': 0,\n          'lower': 0,\n          'last_price': 0,\n          'porcentual_change': 0,\n          'data': []\n        };\n      }\n\n      this.setState({\n        stocks: copyStocks,\n        ready_stock: true\n      });\n    });\n  }\n\n  getInitialExchange(socket) {\n    let copyExchange = {};\n    let stocks = {};\n    socket.emit('STOCKS');\n    socket.on('STOCKS', data => {\n      stocks = data;\n    });\n    socket.emit('EXCHANGES');\n    socket.on('EXCHANGES', data => {\n      for (const num in data) {\n        copyExchange[data[num]['exchange_ticker']] = {\n          'company_ticker': [],\n          'exchange_name': data[num]['name'],\n          'country': data[num]['country'],\n          'stocks': [...data[num]['listed_companies']],\n          'total_volume': 0,\n          'sell_volume': 0,\n          'buy_volume': 0,\n          'quantity': [...data[num]['listed_companies']].length,\n          'participation': 0\n        };\n\n        for (var i in stocks) {\n          if (data[num]['listed_companies'].indexOf(stocks[i]['company_name']) >= 0) {\n            copyExchange[data[num]['exchange_ticker']]['company_ticker'].push(stocks[i]['ticker']);\n          }\n        }\n      }\n\n      this.setState({\n        exchange: copyExchange,\n        ready_exchange: true\n      });\n    });\n  }\n\n  updateStock(socket) {\n    console.log('updateStock');\n    socket.on('UPDATE', data => {\n      if (this.state.ready_stock && this.state.ready_exchange) {\n        var date = new Date(data['time'] * 1000);\n        var hours = date.getHours();\n        var minutes = \"0\" + date.getMinutes();\n        var formattedTime = hours + ':' + minutes.substr(-2);\n        let copyStocks = { ...this.state.stocks\n        };\n        copyStocks[data['ticker']]['data'].push({\n          'time': formattedTime,\n          value: data['value']\n        });\n\n        if (copyStocks[data['ticker']]['lower'] === 0 || copyStocks[data['ticker']]['lower'] > data['value']) {\n          copyStocks[data['ticker']]['lower'] = data['value'];\n        }\n\n        if (copyStocks[data['ticker']]['higher'] < data['value']) {\n          copyStocks[data['ticker']]['higher'] = data['value'];\n        }\n\n        copyStocks[data['ticker']]['porcentual_change'] = Math.round((data['value'] * 100 / copyStocks[data['ticker']]['last_price'] - 100) * 100) / 100;\n        copyStocks[data['ticker']]['last_price'] = data['value'];\n        this.setState({\n          stocks: copyStocks\n        });\n      }\n    });\n  }\n\n  tickerBuy(socket) {\n    socket.on('BUY', data => {\n      if (this.state.ready_stock && this.state.ready_exchange) {\n        let copyStocks = { ...this.state.stocks\n        };\n        let copyExchange = { ...this.state.exchange\n        };\n        let market_total = 0;\n        copyStocks[data['ticker']]['total_volume'] = data['volume'] + copyStocks[data['ticker']]['total_volume'];\n\n        for (const ex in copyExchange) {\n          if (copyExchange[ex]['company_ticker'].indexOf(data['ticker']) >= 0) {\n            copyExchange[ex]['buy_volume'] = data['volume'] + copyExchange[ex]['buy_volume'];\n            copyExchange[ex]['total_volume'] = data['volume'] + copyExchange[ex]['total_volume'];\n          }\n\n          market_total = market_total + copyExchange[ex]['total_volume'];\n        }\n\n        for (const ex in copyExchange) {\n          copyExchange[ex]['participation'] = Math.round(copyExchange[ex]['total_volume'] * 100 / market_total * 100) / 100;\n        }\n\n        this.setState({\n          stocks: copyStocks,\n          exchange: copyExchange\n        });\n      }\n    });\n  }\n\n  tickerSell(socket) {\n    socket.on('SELL', data => {\n      if (this.state.ready_stock && this.state.ready_exchange) {\n        let copyStocks = { ...this.state.stocks\n        };\n        let copyExchange = { ...this.state.exchange\n        };\n        let market_total = 0;\n        copyStocks[data['ticker']]['total_volume'] = data['volume'] + copyStocks[data['ticker']]['total_volume'];\n\n        for (const ex in copyExchange) {\n          if (copyExchange[ex]['company_ticker'].indexOf(data['ticker']) >= 0) {\n            copyExchange[ex]['sell_volume'] = data['volume'] + copyExchange[ex]['sell_volume'];\n            copyExchange[ex]['total_volume'] = data['volume'] + copyExchange[ex]['total_volume'];\n          }\n\n          market_total = market_total + copyExchange[ex]['total_volume'];\n        }\n\n        for (const ex in copyExchange) {\n          copyExchange[ex]['participation'] = Math.round(copyExchange[ex]['total_volume'] * 100 / market_total * 100) / 100;\n        }\n\n        this.setState({\n          stocks: copyStocks,\n          exchange: copyExchange\n        });\n      }\n    });\n  }\n\n  componentDidMount() {\n    var socket = io('wss://le-18262636.bitzonte.com', {\n      path: '/stocks'\n    });\n    this.getInitialStock(socket);\n    this.getInitialExchange(socket);\n    this.updateStock(socket);\n    this.tickerSell(socket);\n    this.tickerBuy(socket);\n  }\n\n  render() {\n    // console.log(this.state.stocks)\n    if (this.state.ready_stock && this.state.ready_exchange) {\n      const {\n        stocks\n      } = this.state;\n      const {\n        exchange\n      } = this.state;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"container\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 190,\n          columnNumber: 9\n        }\n      }, Object.keys(exchange).map((key, index) => /*#__PURE__*/React.createElement(\"div\", {\n        className: \"exchangeTitle\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        style: {\n          color: 'darklateblue'\n        },\n        key: index,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 17\n        }\n      }, exchange[key]['exchange_name']))));\n    } else {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"container\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 9\n        }\n      });\n    }\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/sofiapacheco/Desktop/T3/t3/src/App.js"],"names":["React","io","withStyles","makeStyles","GridList","GridListTile","Table","TableBody","TableCell","TableHead","TableRow","Line","LineChart","XAxis","YAxis","Tooltip","CartesianGrid","StyledTableCell","theme","head","backgroundColor","palette","common","black","color","white","fontSize","body","App","Component","constructor","state","exchange","stocks","ready_stock","ready_exchange","on","getInitialStock","socket","console","log","copyStocks","emit","data","num","setState","getInitialExchange","copyExchange","length","i","indexOf","push","updateStock","date","Date","hours","getHours","minutes","getMinutes","formattedTime","substr","value","Math","round","tickerBuy","market_total","ex","tickerSell","componentDidMount","path","render","Object","keys","map","key","index"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAO,kBAAP;AACA,OAAO,KAAKC,EAAZ,MAAoB,kBAApB;AACA,SAASC,UAAT,EAAqBC,UAArB,QAAuC,0BAAvC;AACA,SACEC,QADF,EAEEC,YAFF,EAGEC,KAHF,EAIEC,SAJF,EAKEC,SALF,EAMEC,SANF,EAOEC,QAPF,QAQO,oBARP;AAUA,SACEC,IADF,EAEEC,SAFF,EAGEC,KAHF,EAIEC,KAJF,EAKEC,OALF,EAMEC,aANF,QAOO,UAPP;AASA,MAAMC,eAAe,GAAGf,UAAU,CAAEgB,KAAD,KAAY;AAC7CC,EAAAA,IAAI,EAAE;AACJC,IAAAA,eAAe,EAAEF,KAAK,CAACG,OAAN,CAAcC,MAAd,CAAqBC,KADlC;AAEJC,IAAAA,KAAK,EAAEN,KAAK,CAACG,OAAN,CAAcC,MAAd,CAAqBG,KAFxB;AAGJC,IAAAA,QAAQ,EAAE;AAHN,GADuC;AAM7CC,EAAAA,IAAI,EAAE;AACJD,IAAAA,QAAQ,EAAE;AADN;AANuC,CAAZ,CAAD,CAAV,CASpBlB,SAToB,CAAxB;;AAWA,MAAMoB,GAAN,SAAkB5B,KAAK,CAAC6B,SAAxB,CAAiC;AAC/BC,EAAAA,WAAW,GAAG;AACZ;AAEA,SAAKC,KAAL,GAAa;AACXC,MAAAA,QAAQ,EAAE,EADC;AAEXC,MAAAA,MAAM,EAAE,EAFG;AAGXC,MAAAA,WAAW,EAAE,KAHF;AAIXC,MAAAA,cAAc,EAAE,KAJL;AAKXC,MAAAA,EAAE,EAAE;AALO,KAAb;AAOD;;AAEDC,EAAAA,eAAe,CAACC,MAAD,EAAS;AACtBC,IAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ;AACA,QAAIC,UAAU,GAAG,EAAjB;AACAH,IAAAA,MAAM,CAACI,IAAP,CAAY,QAAZ;AACAJ,IAAAA,MAAM,CAACF,EAAP,CAAU,QAAV,EAAqBO,IAAD,IAAU;AAC5BJ,MAAAA,OAAO,CAACC,GAAR,CAAYG,IAAZ;;AACA,WAAK,MAAMC,GAAX,IAAkBD,IAAlB,EAAwB;AAEtBF,QAAAA,UAAU,CAACE,IAAI,CAACC,GAAD,CAAJ,CAAU,QAAV,CAAD,CAAV,GAAkC;AAChC,0BAAgBD,IAAI,CAACC,GAAD,CAAJ,CAAU,cAAV,CADgB;AAEhC,qBAAWD,IAAI,CAACC,GAAD,CAAJ,CAAU,SAAV,CAFqB;AAGhC,0BAAgB,CAHgB;AAIhC,oBAAU,CAJsB;AAKhC,mBAAS,CALuB;AAMhC,wBAAc,CANkB;AAOhC,+BAAqB,CAPW;AAQhC,kBAAQ;AARwB,SAAlC;AAUD;;AACD,WAAKC,QAAL,CAAc;AAAEZ,QAAAA,MAAM,EAAEQ,UAAV;AAAsBP,QAAAA,WAAW,EAAE;AAAnC,OAAd;AACD,KAhBD;AAiBD;;AAEDY,EAAAA,kBAAkB,CAACR,MAAD,EAAQ;AACxB,QAAIS,YAAY,GAAG,EAAnB;AACA,QAAId,MAAM,GAAG,EAAb;AACAK,IAAAA,MAAM,CAACI,IAAP,CAAY,QAAZ;AACAJ,IAAAA,MAAM,CAACF,EAAP,CAAU,QAAV,EAAqBO,IAAD,IAAU;AAC5BV,MAAAA,MAAM,GAAGU,IAAT;AACD,KAFD;AAGAL,IAAAA,MAAM,CAACI,IAAP,CAAY,WAAZ;AACAJ,IAAAA,MAAM,CAACF,EAAP,CAAU,WAAV,EAAwBO,IAAD,IAAU;AAE/B,WAAK,MAAMC,GAAX,IAAkBD,IAAlB,EAAwB;AACtBI,QAAAA,YAAY,CAACJ,IAAI,CAACC,GAAD,CAAJ,CAAU,iBAAV,CAAD,CAAZ,GAA6C;AAC3C,4BAAkB,EADyB;AAE3C,2BAAiBD,IAAI,CAACC,GAAD,CAAJ,CAAU,MAAV,CAF0B;AAG3C,qBAAWD,IAAI,CAACC,GAAD,CAAJ,CAAU,SAAV,CAHgC;AAI3C,oBAAS,CAAC,GAAGD,IAAI,CAACC,GAAD,CAAJ,CAAU,kBAAV,CAAJ,CAJkC;AAK3C,0BAAgB,CAL2B;AAM3C,yBAAe,CAN4B;AAO3C,wBAAc,CAP6B;AAQ3C,sBAAa,CAAC,GAAGD,IAAI,CAACC,GAAD,CAAJ,CAAU,kBAAV,CAAJ,CAAD,CAAqCI,MARN;AAS3C,2BAAiB;AAT0B,SAA7C;;AAWA,aAAK,IAAIC,CAAT,IAAchB,MAAd,EAAqB;AACnB,cAAIU,IAAI,CAACC,GAAD,CAAJ,CAAU,kBAAV,EAA8BM,OAA9B,CAAsCjB,MAAM,CAACgB,CAAD,CAAN,CAAU,cAAV,CAAtC,KAAoE,CAAxE,EAA0E;AACxEF,YAAAA,YAAY,CAACJ,IAAI,CAACC,GAAD,CAAJ,CAAU,iBAAV,CAAD,CAAZ,CAA2C,gBAA3C,EAA6DO,IAA7D,CAAkElB,MAAM,CAACgB,CAAD,CAAN,CAAU,QAAV,CAAlE;AACH;AAAC;AACH;;AACD,WAAKJ,QAAL,CAAc;AAAEb,QAAAA,QAAQ,EAAEe,YAAZ;AAA0BZ,QAAAA,cAAc,EAAE;AAA1C,OAAd;AACD,KApBD;AAqBD;;AAEDiB,EAAAA,WAAW,CAACd,MAAD,EAAS;AAElBC,IAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ;AACAF,IAAAA,MAAM,CAACF,EAAP,CAAU,QAAV,EAAoBO,IAAD,IAAU;AAC3B,UAAI,KAAKZ,KAAL,CAAWG,WAAX,IAA0B,KAAKH,KAAL,CAAWI,cAAzC,EAAwD;AACtD,YAAIkB,IAAI,GAAG,IAAIC,IAAJ,CAASX,IAAI,CAAC,MAAD,CAAJ,GAAe,IAAxB,CAAX;AACA,YAAIY,KAAK,GAAGF,IAAI,CAACG,QAAL,EAAZ;AACA,YAAIC,OAAO,GAAG,MAAMJ,IAAI,CAACK,UAAL,EAApB;AACA,YAAIC,aAAa,GAAGJ,KAAK,GAAG,GAAR,GAAcE,OAAO,CAACG,MAAR,CAAe,CAAC,CAAhB,CAAlC;AACA,YAAInB,UAAU,GAAG,EAAE,GAAG,KAAKV,KAAL,CAAWE;AAAhB,SAAjB;AACAQ,QAAAA,UAAU,CAACE,IAAI,CAAC,QAAD,CAAL,CAAV,CAA2B,MAA3B,EAAmCQ,IAAnC,CAAwC;AAAC,kBAAOQ,aAAR;AAAuBE,UAAAA,KAAK,EAAElB,IAAI,CAAC,OAAD;AAAlC,SAAxC;;AACA,YAAIF,UAAU,CAACE,IAAI,CAAC,QAAD,CAAL,CAAV,CAA2B,OAA3B,MAAuC,CAAvC,IAA4CF,UAAU,CAACE,IAAI,CAAC,QAAD,CAAL,CAAV,CAA2B,OAA3B,IAAsCA,IAAI,CAAC,OAAD,CAA1F,EAAoG;AAClGF,UAAAA,UAAU,CAACE,IAAI,CAAC,QAAD,CAAL,CAAV,CAA2B,OAA3B,IAAsCA,IAAI,CAAC,OAAD,CAA1C;AACD;;AACD,YAAIF,UAAU,CAACE,IAAI,CAAC,QAAD,CAAL,CAAV,CAA2B,QAA3B,IAAuCA,IAAI,CAAC,OAAD,CAA/C,EAAyD;AACvDF,UAAAA,UAAU,CAACE,IAAI,CAAC,QAAD,CAAL,CAAV,CAA2B,QAA3B,IAAuCA,IAAI,CAAC,OAAD,CAA3C;AACD;;AACDF,QAAAA,UAAU,CAACE,IAAI,CAAC,QAAD,CAAL,CAAV,CAA2B,mBAA3B,IAAkDmB,IAAI,CAACC,KAAL,CAAW,CAAEpB,IAAI,CAAC,OAAD,CAAJ,GAAc,GAAd,GAAkBF,UAAU,CAACE,IAAI,CAAC,QAAD,CAAL,CAAV,CAA2B,YAA3B,CAAnB,GAA6D,GAA9D,IAAqE,GAAhF,IAAuF,GAAzI;AACAF,QAAAA,UAAU,CAACE,IAAI,CAAC,QAAD,CAAL,CAAV,CAA2B,YAA3B,IAA2CA,IAAI,CAAC,OAAD,CAA/C;AACA,aAAKE,QAAL,CAAc;AAAEZ,UAAAA,MAAM,EAAEQ;AAAV,SAAd;AACD;AACF,KAlBD;AAmBD;;AAEDuB,EAAAA,SAAS,CAAC1B,MAAD,EAAS;AAChBA,IAAAA,MAAM,CAACF,EAAP,CAAU,KAAV,EAAiBO,IAAD,IAAU;AACxB,UAAI,KAAKZ,KAAL,CAAWG,WAAX,IAA0B,KAAKH,KAAL,CAAWI,cAAzC,EAAwD;AACtD,YAAIM,UAAU,GAAG,EAAC,GAAG,KAAKV,KAAL,CAAWE;AAAf,SAAjB;AACA,YAAIc,YAAY,GAAG,EAAE,GAAG,KAAKhB,KAAL,CAAWC;AAAhB,SAAnB;AACA,YAAIiC,YAAY,GAAG,CAAnB;AACAxB,QAAAA,UAAU,CAACE,IAAI,CAAC,QAAD,CAAL,CAAV,CAA2B,cAA3B,IAA6CA,IAAI,CAAC,QAAD,CAAJ,GAAiBF,UAAU,CAACE,IAAI,CAAC,QAAD,CAAL,CAAV,CAA2B,cAA3B,CAA9D;;AACA,aAAK,MAAMuB,EAAX,IAAiBnB,YAAjB,EAA8B;AAC5B,cAAIA,YAAY,CAACmB,EAAD,CAAZ,CAAiB,gBAAjB,EAAmChB,OAAnC,CAA2CP,IAAI,CAAC,QAAD,CAA/C,KAA8D,CAAlE,EAAoE;AAClEI,YAAAA,YAAY,CAACmB,EAAD,CAAZ,CAAiB,YAAjB,IAAiCvB,IAAI,CAAC,QAAD,CAAJ,GAAiBI,YAAY,CAACmB,EAAD,CAAZ,CAAiB,YAAjB,CAAlD;AACAnB,YAAAA,YAAY,CAACmB,EAAD,CAAZ,CAAiB,cAAjB,IAAmCvB,IAAI,CAAC,QAAD,CAAJ,GAAiBI,YAAY,CAACmB,EAAD,CAAZ,CAAiB,cAAjB,CAApD;AACD;;AACDD,UAAAA,YAAY,GAAGA,YAAY,GAAGlB,YAAY,CAACmB,EAAD,CAAZ,CAAiB,cAAjB,CAA9B;AACD;;AACD,aAAK,MAAMA,EAAX,IAAiBnB,YAAjB,EAA8B;AAC5BA,UAAAA,YAAY,CAACmB,EAAD,CAAZ,CAAiB,eAAjB,IAAoCJ,IAAI,CAACC,KAAL,CAAahB,YAAY,CAACmB,EAAD,CAAZ,CAAiB,cAAjB,IAAiC,GAAlC,GAAuCD,YAAxC,GAAwD,GAAnE,IAA0E,GAA9G;AACD;;AACD,aAAKpB,QAAL,CAAc;AAAEZ,UAAAA,MAAM,EAAEQ,UAAV;AAAsBT,UAAAA,QAAQ,EAAEe;AAAhC,SAAd;AACD;AACF,KAlBD;AAmBD;;AAEDoB,EAAAA,UAAU,CAAC7B,MAAD,EAAS;AACjBA,IAAAA,MAAM,CAACF,EAAP,CAAU,MAAV,EAAkBO,IAAD,IAAU;AACzB,UAAI,KAAKZ,KAAL,CAAWG,WAAX,IAA0B,KAAKH,KAAL,CAAWI,cAAzC,EAAwD;AACtD,YAAIM,UAAU,GAAG,EAAC,GAAG,KAAKV,KAAL,CAAWE;AAAf,SAAjB;AACA,YAAIc,YAAY,GAAG,EAAC,GAAG,KAAKhB,KAAL,CAAWC;AAAf,SAAnB;AACA,YAAIiC,YAAY,GAAG,CAAnB;AACAxB,QAAAA,UAAU,CAACE,IAAI,CAAC,QAAD,CAAL,CAAV,CAA2B,cAA3B,IAA6CA,IAAI,CAAC,QAAD,CAAJ,GAAiBF,UAAU,CAACE,IAAI,CAAC,QAAD,CAAL,CAAV,CAA2B,cAA3B,CAA9D;;AACA,aAAK,MAAMuB,EAAX,IAAkBnB,YAAlB,EAA+B;AAC7B,cAAIA,YAAY,CAACmB,EAAD,CAAZ,CAAiB,gBAAjB,EAAmChB,OAAnC,CAA2CP,IAAI,CAAC,QAAD,CAA/C,KAA8D,CAAlE,EAAoE;AAClEI,YAAAA,YAAY,CAACmB,EAAD,CAAZ,CAAiB,aAAjB,IAAkCvB,IAAI,CAAC,QAAD,CAAJ,GAAiBI,YAAY,CAACmB,EAAD,CAAZ,CAAiB,aAAjB,CAAnD;AACAnB,YAAAA,YAAY,CAACmB,EAAD,CAAZ,CAAiB,cAAjB,IAAmCvB,IAAI,CAAC,QAAD,CAAJ,GAAiBI,YAAY,CAACmB,EAAD,CAAZ,CAAiB,cAAjB,CAApD;AACD;;AACDD,UAAAA,YAAY,GAAGA,YAAY,GAAGlB,YAAY,CAACmB,EAAD,CAAZ,CAAiB,cAAjB,CAA9B;AACD;;AACD,aAAK,MAAMA,EAAX,IAAiBnB,YAAjB,EAA8B;AAC5BA,UAAAA,YAAY,CAACmB,EAAD,CAAZ,CAAiB,eAAjB,IAAoCJ,IAAI,CAACC,KAAL,CAAahB,YAAY,CAACmB,EAAD,CAAZ,CAAiB,cAAjB,IAAiC,GAAlC,GAAuCD,YAAxC,GAAwD,GAAnE,IAA0E,GAA9G;AACD;;AACD,aAAKpB,QAAL,CAAc;AAAEZ,UAAAA,MAAM,EAAEQ,UAAV;AAAsBT,UAAAA,QAAQ,EAAEe;AAAhC,SAAd;AACD;AACF,KAlBD;AAmBD;;AAGDqB,EAAAA,iBAAiB,GAAG;AAClB,QAAI9B,MAAM,GAAGrC,EAAE,CAAC,gCAAD,EAAmC;AAChDoE,MAAAA,IAAI,EAAE;AAD0C,KAAnC,CAAf;AAGA,SAAKhC,eAAL,CAAqBC,MAArB;AACA,SAAKQ,kBAAL,CAAwBR,MAAxB;AACA,SAAKc,WAAL,CAAiBd,MAAjB;AACA,SAAK6B,UAAL,CAAgB7B,MAAhB;AACA,SAAK0B,SAAL,CAAe1B,MAAf;AACF;;AAGAgC,EAAAA,MAAM,GAAI;AACR;AACA,QAAI,KAAKvC,KAAL,CAAWG,WAAX,IAA0B,KAAKH,KAAL,CAAWI,cAAzC,EAAyD;AACvD,YAAM;AAAEF,QAAAA;AAAF,UAAa,KAAKF,KAAxB;AACA,YAAM;AAAEC,QAAAA;AAAF,UAAe,KAAKD,KAA1B;AAEA,0BACE;AAAK,QAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAEIwC,MAAM,CAACC,IAAP,CAAYxC,QAAZ,EAAsByC,GAAtB,CAA0B,CAACC,GAAD,EAAMC,KAAN,kBACxB;AAAK,QAAA,SAAS,EAAC,eAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACE;AAAG,QAAA,KAAK,EAAE;AAACnD,UAAAA,KAAK,EAAE;AAAR,SAAV;AAAmC,QAAA,GAAG,EAAEmD,KAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAgD3C,QAAQ,CAAC0C,GAAD,CAAR,CAAc,eAAd,CAAhD,CADF,CADF,CAFJ,CADF;AAWD,KAfD,MAeO;AACL,0BACE;AAAK,QAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF;AAID;AACF;;AA3K8B;;AA+KjC,eAAe9C,GAAf","sourcesContent":["import React from 'react';\nimport './styles/App.css';\nimport * as io from 'socket.io-client';\nimport { withStyles, makeStyles } from '@material-ui/core/styles';\nimport { \n  GridList, \n  GridListTile, \n  Table, \n  TableBody, \n  TableCell, \n  TableHead, \n  TableRow \n} from '@material-ui/core/';\n\nimport {\n  Line,\n  LineChart,\n  XAxis,\n  YAxis,\n  Tooltip, \n  CartesianGrid\n} from 'recharts';\n\nconst StyledTableCell = withStyles((theme) => ({\n  head: {\n    backgroundColor: theme.palette.common.black,\n    color: theme.palette.common.white,\n    fontSize: 12\n  },\n  body: {\n    fontSize: 12,\n  },\n}))(TableCell);\n\nclass App extends React.Component{\n  constructor() {\n    super();\n    \n    this.state = {\n      exchange: {},\n      stocks: {},\n      ready_stock: false,\n      ready_exchange: false,\n      on: false\n    };\n  }\n  \n  getInitialStock(socket) {\n    console.log('hola')\n    let copyStocks = {};\n    socket.emit('STOCKS');\n    socket.on('STOCKS', (data) => {\n      console.log(data)\n      for (const num in data) {\n        \n        copyStocks[data[num]['ticker']] = {\n          'company_name': data[num]['company_name'],\n          'country': data[num]['country'],\n          'total_volume': 0,\n          'higher': 0,\n          'lower': 0,\n          'last_price': 0,\n          'porcentual_change': 0,\n          'data': [],\n        };\n      }\n      this.setState({ stocks: copyStocks, ready_stock: true });\n    });\n  }\n\n  getInitialExchange(socket){\n    let copyExchange = {}\n    let stocks = {}\n    socket.emit('STOCKS')\n    socket.on('STOCKS', (data) => {\n      stocks = data\n    });\n    socket.emit('EXCHANGES')\n    socket.on('EXCHANGES', (data) => {\n      \n      for (const num in data) {\n        copyExchange[data[num]['exchange_ticker']] = {\n          'company_ticker': [],\n          'exchange_name': data[num]['name'],\n          'country': data[num]['country'],\n          'stocks':[...data[num]['listed_companies']],\n          'total_volume': 0,\n          'sell_volume': 0,\n          'buy_volume': 0,\n          'quantity': ([...data[num]['listed_companies']]).length,\n          'participation': 0\n        }\n        for (var i in stocks){\n          if (data[num]['listed_companies'].indexOf(stocks[i]['company_name']) >= 0){\n            copyExchange[data[num]['exchange_ticker']]['company_ticker'].push(stocks[i]['ticker'])\n        }}      \n      }\n      this.setState({ exchange: copyExchange, ready_exchange: true });\n    });\n  }\n\n  updateStock(socket) {\n\n    console.log('updateStock');\n    socket.on('UPDATE',(data) => {\n      if (this.state.ready_stock && this.state.ready_exchange){\n        var date = new Date(data['time'] * 1000)\n        var hours = date.getHours()\n        var minutes = \"0\" + date.getMinutes()\n        var formattedTime = hours + ':' + minutes.substr(-2)\n        let copyStocks = { ...this.state.stocks };\n        copyStocks[data['ticker']]['data'].push({'time':formattedTime, value :data['value']});\n        if (copyStocks[data['ticker']]['lower']=== 0 || copyStocks[data['ticker']]['lower'] > data['value']){\n          copyStocks[data['ticker']]['lower'] = data['value']\n        }\n        if (copyStocks[data['ticker']]['higher'] < data['value']){\n          copyStocks[data['ticker']]['higher'] = data['value']\n        }\n        copyStocks[data['ticker']]['porcentual_change'] = Math.round(((data['value']*100/copyStocks[data['ticker']]['last_price'])-100) * 100) / 100\n        copyStocks[data['ticker']]['last_price'] = data['value']\n        this.setState({ stocks: copyStocks })\n      }\n    });\n  }\n\n  tickerBuy(socket) {\n    socket.on('BUY',(data) => {\n      if (this.state.ready_stock && this.state.ready_exchange){\n        let copyStocks = {...this.state.stocks }\n        let copyExchange = { ...this.state.exchange }\n        let market_total = 0\n        copyStocks[data['ticker']]['total_volume'] = data['volume'] + copyStocks[data['ticker']]['total_volume']\n        for (const ex in copyExchange){\n          if (copyExchange[ex]['company_ticker'].indexOf(data['ticker']) >= 0){\n            copyExchange[ex]['buy_volume'] = data['volume'] + copyExchange[ex]['buy_volume']\n            copyExchange[ex]['total_volume'] = data['volume'] + copyExchange[ex]['total_volume']\n          }\n          market_total = market_total + copyExchange[ex]['total_volume']\n        }\n        for (const ex in copyExchange){\n          copyExchange[ex]['participation'] = Math.round(((copyExchange[ex]['total_volume']*100)/market_total) * 100) / 100\n        }\n        this.setState({ stocks: copyStocks, exchange: copyExchange })\n      }\n    });\n  }\n\n  tickerSell(socket) {\n    socket.on('SELL',(data) => {\n      if (this.state.ready_stock && this.state.ready_exchange){\n        let copyStocks = {...this.state.stocks }\n        let copyExchange = {...this.state.exchange}\n        let market_total = 0\n        copyStocks[data['ticker']]['total_volume'] = data['volume'] + copyStocks[data['ticker']]['total_volume']\n        for (const ex in  copyExchange){\n          if (copyExchange[ex]['company_ticker'].indexOf(data['ticker']) >= 0){\n            copyExchange[ex]['sell_volume'] = data['volume'] + copyExchange[ex]['sell_volume']\n            copyExchange[ex]['total_volume'] = data['volume'] + copyExchange[ex]['total_volume']\n          }\n          market_total = market_total + copyExchange[ex]['total_volume']\n        }\n        for (const ex in copyExchange){\n          copyExchange[ex]['participation'] = Math.round(((copyExchange[ex]['total_volume']*100)/market_total) * 100) / 100\n        }\n        this.setState({ stocks: copyStocks, exchange: copyExchange })\n      }\n    });\n  }\n\n\n  componentDidMount() {\n    var socket = io('wss://le-18262636.bitzonte.com', {\n      path: '/stocks'\n    });\n    this.getInitialStock(socket);\n    this.getInitialExchange(socket);\n    this.updateStock(socket);\n    this.tickerSell(socket);\n    this.tickerBuy(socket);\n }\n\n  \n  render () {\n    // console.log(this.state.stocks)\n    if (this.state.ready_stock && this.state.ready_exchange) {\n      const { stocks } = this.state;\n      const { exchange } = this.state;\n      \n      return (\n        <div className=\"container\">\n          {\n            Object.keys(exchange).map((key, index) => (\n              <div className=\"exchangeTitle\">\n                <p style={{color: 'darklateblue'}} key={index}>{exchange[key]['exchange_name']}</p>\n              </div> \n            ))\n          }\n        </div>\n      );\n    } else { \n      return( \n        <div className=\"container\">\n        </div>\n      ); \n    }\n  }\n    \n} \n\nexport default App;"]},"metadata":{},"sourceType":"module"}